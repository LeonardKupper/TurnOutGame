
@using TurnOut.Core.Services
@using TurnOut.Core.Models
@inject ClientService _clientService

    <!-- background -->
    <div style="position: absolute; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 0;">
        <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" fill="none">

            <rect width="100%" height="100%" fill="url(#paint0_linear)" />
            <rect width="100%" height="100%" fill="url(#simple-dots)" />

            <defs>
                <linearGradient id="paint0_linear" x1="720" y1="0" x2="720" y2="1024" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#2C2C30" />
                    <stop offset="0.53125" stop-color="#404344" />
                    <stop offset="1" stop-color="#424847" />
                </linearGradient>
                <clipPath id="clip0">
                    <rect width="1440" height="1024" fill="white" />
                </clipPath>
                <pattern id="simple-dots" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse">
                    <line x1="2" y1="0" x2="2" y2="40" stroke="#D5D5D5" stroke-opacity="0.01" stroke-width="4" />
                    <line x1="0" y1="2" x2="40" y2="2" stroke="#D5D5D5" stroke-opacity="0.01" stroke-width="4" />

                    <!-- 1.04+(sin(2*x)*0.04) for x=[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0,3.1] -->

                    <animateTransform attributeType="xml"
                                      attributeName="patternTransform"
                                      type="scale" values="1.04795; 1.05558; 1.06259; 1.06869; 1.07366; 1.07728; 1.07942; 1.07998; 1.07895; 1.07637; 1.07234; 1.06702; 1.06062; 1.0534; 1.04564; 1.03767; 1.02978; 1.0223; 1.01553; 1.00973; 1.00514; 1.00194; 1.00025; 1.00015; 1.00164; 1.00466; 1.00909; 1.01475; 1.02142; 1.02882; 1.03668" begin="0"
                                      dur="20s" repeatCount="indefinite" additive="sum" />
                    <animateTransform attributeType="xml"
                                      attributeName="patternTransform"
                                      type="translate" from="0 0" to="400 320" begin="0"
                                      dur="14s" repeatCount="indefinite" additive="sum" />
                </pattern>
            </defs>
        </svg>
    </div>

    <!-- width: 60vw; transform: translate(20vw, 45vh); transition: all 2s; -->
    <svg class="@($"loc {(ShowWelcomeTitle ? "loc-hcvc" : "loc-hrvt")} loc-smooth breathingOpacity")" style="@($"width: {(ShowWelcomeTitle ? 60 : 20)}vw; transition: all 2s;")" xmlns="http://www.w3.org/2000/svg" viewBox="320 465 800 100" fill="none">
        <g xmlns="http://www.w3.org/2000/svg" filter="url(#filter0_f)">
            <path d="M476.608 540V497.736H455.44V488.16H507.28V497.736H486.184V540H476.608ZM557.089 540C554.353 540 552.001 539.016 550.033 537.048C548.065 535.08 547.081 532.728 547.081 529.992V488.16H556.585V527.904C556.585 529.248 556.657 530.016 556.801 530.208C556.993 530.352 557.761 530.424 559.105 530.424H586.825C588.121 530.424 588.865 530.352 589.057 530.208C589.249 530.016 589.345 529.248 589.345 527.904V488.16H598.921V529.992C598.921 532.728 597.937 535.08 595.969 537.048C594.001 539.016 591.649 540 588.913 540H557.089ZM641.338 540V488.232H683.098C685.882 488.232 688.258 489.24 690.226 491.256C692.194 493.224 693.178 495.552 693.178 498.24V512.208C693.178 514.944 692.194 517.296 690.226 519.264C688.258 521.232 685.882 522.216 683.098 522.216H680.29L693.106 537.336V540H682.738L667.834 522.216L650.842 522.288V540H641.338ZM653.362 512.64H681.082C682.378 512.64 683.098 512.568 683.242 512.424C683.434 512.28 683.53 511.536 683.53 510.192V500.256C683.53 498.912 683.434 498.168 683.242 498.024C683.098 497.832 682.378 497.736 681.082 497.736H653.362C652.018 497.736 651.25 497.832 651.058 498.024C650.914 498.168 650.842 498.912 650.842 500.256V510.192C650.842 511.536 650.914 512.28 651.058 512.424C651.25 512.568 652.018 512.64 653.362 512.64ZM735.384 540V488.16H745.824L777.648 526.032V488.16H787.224V540H776.784L744.888 502.056V540H735.384ZM839.714 540C836.978 540 834.626 539.016 832.658 537.048C830.69 535.08 829.706 532.728 829.706 529.992V498.168C829.706 495.432 830.69 493.08 832.658 491.112C834.626 489.144 836.978 488.16 839.714 488.16H871.538C874.274 488.16 876.626 489.144 878.594 491.112C880.562 493.08 881.546 495.432 881.546 498.168V529.992C881.546 532.728 880.562 535.08 878.594 537.048C876.626 539.016 874.274 540 871.538 540H839.714ZM841.73 530.424H869.45C870.746 530.424 871.49 530.352 871.682 530.208C871.874 530.016 871.97 529.248 871.97 527.904V500.256C871.97 498.912 871.874 498.168 871.682 498.024C871.49 497.832 870.746 497.736 869.45 497.736H841.73C840.386 497.736 839.618 497.832 839.426 498.024C839.282 498.168 839.21 498.912 839.21 500.256V527.904C839.21 529.248 839.282 530.016 839.426 530.208C839.618 530.352 840.386 530.424 841.73 530.424ZM933.899 540C931.163 540 928.811 539.016 926.843 537.048C924.875 535.08 923.891 532.728 923.891 529.992V488.16H933.395V527.904C933.395 529.248 933.467 530.016 933.611 530.208C933.803 530.352 934.571 530.424 935.915 530.424H963.635C964.931 530.424 965.675 530.352 965.867 530.208C966.059 530.016 966.155 529.248 966.155 527.904V488.16H975.731V529.992C975.731 532.728 974.747 535.08 972.779 537.048C970.811 539.016 968.459 540 965.723 540H933.899ZM1036.8 540V497.736H1015.63V488.16H1067.47V497.736H1046.37V540H1036.8Z" fill="#0FFDB0" />
        </g>
        <path xmlns="http://www.w3.org/2000/svg" d="M476.608 540V497.736H455.44V488.16H507.28V497.736H486.184V540H476.608ZM557.089 540C554.353 540 552.001 539.016 550.033 537.048C548.065 535.08 547.081 532.728 547.081 529.992V488.16H556.585V527.904C556.585 529.248 556.657 530.016 556.801 530.208C556.993 530.352 557.761 530.424 559.105 530.424H586.825C588.121 530.424 588.865 530.352 589.057 530.208C589.249 530.016 589.345 529.248 589.345 527.904V488.16H598.921V529.992C598.921 532.728 597.937 535.08 595.969 537.048C594.001 539.016 591.649 540 588.913 540H557.089ZM641.338 540V488.232H683.098C685.882 488.232 688.258 489.24 690.226 491.256C692.194 493.224 693.178 495.552 693.178 498.24V512.208C693.178 514.944 692.194 517.296 690.226 519.264C688.258 521.232 685.882 522.216 683.098 522.216H680.29L693.106 537.336V540H682.738L667.834 522.216L650.842 522.288V540H641.338ZM653.362 512.64H681.082C682.378 512.64 683.098 512.568 683.242 512.424C683.434 512.28 683.53 511.536 683.53 510.192V500.256C683.53 498.912 683.434 498.168 683.242 498.024C683.098 497.832 682.378 497.736 681.082 497.736H653.362C652.018 497.736 651.25 497.832 651.058 498.024C650.914 498.168 650.842 498.912 650.842 500.256V510.192C650.842 511.536 650.914 512.28 651.058 512.424C651.25 512.568 652.018 512.64 653.362 512.64ZM735.384 540V488.16H745.824L777.648 526.032V488.16H787.224V540H776.784L744.888 502.056V540H735.384ZM839.714 540C836.978 540 834.626 539.016 832.658 537.048C830.69 535.08 829.706 532.728 829.706 529.992V498.168C829.706 495.432 830.69 493.08 832.658 491.112C834.626 489.144 836.978 488.16 839.714 488.16H871.538C874.274 488.16 876.626 489.144 878.594 491.112C880.562 493.08 881.546 495.432 881.546 498.168V529.992C881.546 532.728 880.562 535.08 878.594 537.048C876.626 539.016 874.274 540 871.538 540H839.714ZM841.73 530.424H869.45C870.746 530.424 871.49 530.352 871.682 530.208C871.874 530.016 871.97 529.248 871.97 527.904V500.256C871.97 498.912 871.874 498.168 871.682 498.024C871.49 497.832 870.746 497.736 869.45 497.736H841.73C840.386 497.736 839.618 497.832 839.426 498.024C839.282 498.168 839.21 498.912 839.21 500.256V527.904C839.21 529.248 839.282 530.016 839.426 530.208C839.618 530.352 840.386 530.424 841.73 530.424ZM933.899 540C931.163 540 928.811 539.016 926.843 537.048C924.875 535.08 923.891 532.728 923.891 529.992V488.16H933.395V527.904C933.395 529.248 933.467 530.016 933.611 530.208C933.803 530.352 934.571 530.424 935.915 530.424H963.635C964.931 530.424 965.675 530.352 965.867 530.208C966.059 530.016 966.155 529.248 966.155 527.904V488.16H975.731V529.992C975.731 532.728 974.747 535.08 972.779 537.048C970.811 539.016 968.459 540 965.723 540H933.899ZM1036.8 540V497.736H1015.63V488.16H1067.47V497.736H1046.37V540H1036.8Z" fill="#0FFDB0" />
        <g xmlns="http://www.w3.org/2000/svg" filter="url(#filter1_f)">
            <path d="M416.355 521.849C417.215 522.79 417.215 524.317 416.355 525.258L409.011 533.292C407.633 534.8 405.25 533.743 405.25 531.588V527.571H399.854C399.703 527.571 399.553 527.537 399.415 527.472C399.276 527.406 399.151 527.309 399.048 527.189L392.572 519.595L397.467 513.855L402.312 519.536H405.25V515.52C405.25 513.366 407.631 512.306 409.011 513.815L416.355 521.849ZM371.102 503.464H378.812L383.658 509.145L388.553 503.405L382.077 495.811C381.974 495.691 381.849 495.594 381.71 495.528C381.572 495.463 381.422 495.429 381.271 495.429H371.102C370.493 495.429 370 495.968 370 496.634V502.259C370 502.925 370.493 503.464 371.102 503.464ZM405.25 503.464V507.481C405.25 509.636 407.633 510.693 409.011 509.185L416.355 501.151C417.215 500.21 417.215 498.683 416.355 497.742L409.011 489.708C407.631 488.199 405.25 489.259 405.25 491.413V495.429H399.854C399.703 495.429 399.553 495.463 399.415 495.528C399.276 495.594 399.151 495.691 399.048 495.811L378.812 519.536H371.102C370.493 519.536 370 520.075 370 520.741V526.366C370 527.032 370.493 527.571 371.102 527.571H381.271C381.577 527.571 381.868 527.433 382.077 527.189L402.312 503.464H405.25Z" fill="#0FFDB0" />
        </g>
        <path xmlns="http://www.w3.org/2000/svg" d="M416.355 521.849C417.215 522.79 417.215 524.317 416.355 525.258L409.011 533.292C407.633 534.8 405.25 533.743 405.25 531.588V527.571H399.854C399.703 527.571 399.553 527.537 399.415 527.472C399.276 527.406 399.151 527.309 399.048 527.189L392.572 519.595L397.467 513.855L402.312 519.536H405.25V515.52C405.25 513.366 407.631 512.306 409.011 513.815L416.355 521.849ZM371.102 503.464H378.812L383.658 509.145L388.553 503.405L382.077 495.811C381.974 495.691 381.849 495.594 381.71 495.528C381.572 495.463 381.422 495.429 381.271 495.429H371.102C370.493 495.429 370 495.968 370 496.634V502.259C370 502.925 370.493 503.464 371.102 503.464ZM405.25 503.464V507.481C405.25 509.636 407.633 510.693 409.011 509.185L416.355 501.151C417.215 500.21 417.215 498.683 416.355 497.742L409.011 489.708C407.631 488.199 405.25 489.259 405.25 491.413V495.429H399.854C399.703 495.429 399.553 495.463 399.415 495.528C399.276 495.594 399.151 495.691 399.048 495.811L378.812 519.536H371.102C370.493 519.536 370 520.075 370 520.741V526.366C370 527.032 370.493 527.571 371.102 527.571H381.271C381.577 527.571 381.868 527.433 382.077 527.189L402.312 503.464H405.25Z" fill="#0FFDB0" />

        <defs>
            <filter xmlns="http://www.w3.org/2000/svg" id="filter0_f" x="440.44" y="473.16" width="642.028" height="81.84" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                <feFlood flood-opacity="0" result="BackgroundImageFix" />
                <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
                <feGaussianBlur stdDeviation="7.5" result="effect1_foregroundBlur" />
            </filter>
            <filter xmlns="http://www.w3.org/2000/svg" id="filter1_f" x="355" y="474" width="77" height="75" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                <feFlood flood-opacity="0" result="BackgroundImageFix" />
                <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
                <feGaussianBlur stdDeviation="7.5" result="effect1_foregroundBlur" />
            </filter>
        </defs>
    </svg>

    <div class="loc loc-hcvb loc-smooth" style="@($"opacity: {(ShowWelcomeTitle ? 1 : 0)}; text-align: center; transition: all 0.25s;")">
        <p class="menuText">Click to start</p>
    </div>

    @if (_clientService.CurrentScreen == GameScreen.Welcome)
    {
        <div style="position: absolute; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 0; cursor: pointer;"
             @onclick="DisplayMainMenu"></div>
    }
    


    <CascadingValue Value="_clientService">

        <MainMenuScreen></MainMenuScreen>
        <SessionLobbyScreen></SessionLobbyScreen>

    </CascadingValue>


    @code {

        public Player ConnectedPlayer => _clientService.Player;

        // This function will be called after a user connects to the TurnOut game application
        protected override Task OnInitializedAsync()
        {
            return base.OnInitializedAsync();
        }

        public void DisplayMainMenu()
        {
            _clientService.SwitchToScreen(GameScreen.MainMenu);
        }

        public bool ShowWelcomeTitle => (_clientService.CurrentScreen == GameScreen.Welcome);

    }
